<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="ChenXin Zhang (cz2634), JingYao Geng (jg4294), Liner Ge (lg3156), YiFan Su (ys3394)" />


<title>US Overweight and Obesity (BMI) Analysis (From 2011 to Present)</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="final_report.html">Final Report</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="index.html">US Overweight and Obesity</a>
</li>
<li>
  <a href="about.html">Fact Sheet</a>
</li>
<li>
  <a href="regression_models.html">Regression Analysis</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    US Obesity Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="p8105_proposal.html">Proposal</a>
    </li>
    <li>
      <a href="overview.html">U.S. Overview</a>
    </li>
    <li>
      <a href="Visualization.html">Nebraska</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://gjy2020.shinyapps.io/Visualization/">
    <span class="fa fa-bar-chart fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/chenxin214/p8105_final_project">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">US Overweight and Obesity (BMI) Analysis (From 2011 to Present)</h1>
<h4 class="author">ChenXin Zhang (cz2634), JingYao Geng (jg4294), Liner Ge (lg3156), YiFan Su (ys3394)</h4>

</div>


<div id="motivation" class="section level1">
<h1>Motivation</h1>
<p>According to <a href="https://www.who.int/news-room/fact-sheets/detail/obesity-and-overweight">the World Health Organization (WHO)</a>, more than two-thirds of adults are obese or overweight and one-sixth of children are obese in the US. Obesity is <a href="https://easo.org/media-portal/statistics/">the fifth leading risk</a> for global death. People overweight have a higher risk of getting more than <a href="https://www.healthline.com/health/obesity-facts">60 chronic diseases</a> like type 2 diabetes, heart disease, which also increases the medical cost. The association between obesity and education level, income is intricate and differs by gender, age, and race.</p>
</div>
<div id="related-work" class="section level1">
<h1>Related Work</h1>
<p>A combination of contributing factors such as gender, age, race, genetic, physical activity, inactivity, dietary patterns and other factors are related to obese and obesity, which is complex and need statistic analysis to clarify. We get inspired from sources related to these influence factors:</p>
<ul>
<li><p>“What causes obesity &amp; overweight?”, <em>NIH</em>, 2016.<a href="https://www.nichd.nih.gov/health/topics/obesity/conditioninfo/cause">Link</a></p></li>
<li><p>“The Impact of Obesity on Your Body and Health”, <em>ASMBS</em>, 2020.<a href="https://asmbs.org/patients/impact-of-obesity">Link</a></p></li>
<li><p>“Global Gender Disparities in Obesity: A Review”, <em>NCBI</em>, 2012.<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3649717/">Link</a></p></li>
<li><p>“Relationship between Age and the Prevalence of Obesity and Overweight in Saudi Population”, <em>Google</em>, 2002. <a href="https://www.bahrainmedicalbulletin.com/june_2002/relationship.pdf">Link</a></p></li>
<li><p>“Social and Environmental Factors Influencing Obesity”, <em>Endotext</em>, 2019.<a href="https://www.ncbi.nlm.nih.gov/books/NBK278977/">Link</a></p></li>
</ul>
</div>
<div id="initial-questions" class="section level1">
<h1>Initial Questions</h1>
<ul>
<li>How obese/overweight change from 2011 to present in the US?</li>
<li>How gender, race, education level, household income are associated with obese and overweight over the US?</li>
<li>Which state has highest average obese and overweight per year among all the states? And what is the distribution of obese/overweight by gender, race, education level, household income in the state?</li>
</ul>
</div>
<div id="data" class="section level1">
<h1>Data</h1>
<div id="data-source" class="section level3">
<h3>Data source</h3>
<ul>
<li>Primary data source: Data collected from Behavioral Risk Factor Sureillance System <a href="https://chronicdata.cdc.gov/Behavioral-Risk-Factors/BRFSS-Table-of-Overweight-and-Obesity-BMI-/fqb7-mgjf">(BRFSS)</a><br />
</li>
<li>Supplemental data source: Centers for Diseases Control and Prevention <a href="https://www.cdc.gov/obesity/data/prevalence-maps.html#age">(CDC)</a></li>
</ul>
</div>
<div id="variable-of-interest" class="section level3">
<h3>Variable of Interest</h3>
<p><strong>Outcomes</strong></p>
<ul>
<li><code>obese_overweight:</code> Count of obese and overweight per year of all sates.</li>
<li><code>obese_overweight_rate:</code> Prevalence. Getting it by dividing the number of people with obese/overweight by total number of population in data multiplied by 100.</li>
</ul>
<p><strong>Candidate Predictors</strong></p>
<ul>
<li><p><code>year:</code> 2011 - 2019</p></li>
<li><p><code>locationabbr:</code> state abbreviation, 56 states</p></li>
<li><p><code>locationdesc:</code> state name, 56 states</p></li>
<li><p><code>response:</code> normal weight (bmi 18.5-24.9); obese (bmi 30.0 - 99.8); overweight (bmi 25.0-29.9); underweight (bmi 12.0-18.4)</p></li>
<li><p><code>break_out_category:</code> race/ethnicity; age group; household income; education attained; gender; overall</p></li>
<li><p><code>break_out:</code> male; college graduate; white, non-Hispanic; <code>$35,000-$49,999</code>; <code>$25,000-$34,999</code>; <code>$15,000-$24,999</code>; 35-44; 25-34; 18-24; 55-64; (other) ; overall; some post-H.S.</p></li>
<li><p><code>sample_size:</code> number of people in each category</p></li>
<li><p><code>data_value:</code> crude prevalence, unit %, such as 14.7 means 14.7%</p></li>
<li><p><code>confidence_limit_low:</code> the value that rank the 25%th of the tatall value</p></li>
<li><p><code>confidence_limit_high:</code> the value that rank the 75%th of the tatall value</p></li>
<li><p><code>geo_location:</code> longitude and latitude</p></li>
<li><p><code>break_out_category_id:</code> gender(CAT2), age(CAT3), race/ethnicity(CAT4), education(CAT5)</p></li>
<li><p><code>breakout_id:</code> eg: sex1, sex2, (in CAT2)</p></li>
<li><p><code>location_id:</code> eg: 01, stands for different state</p></li>
<li><p><code>response_id:</code> eg: RESP041.</p></li>
</ul>
</div>
<div id="data-cleaning" class="section level3">
<h3>Data Cleaning</h3>
<p>First, import the data from Behavioral Risk Factor Sureillance System. We clean the data and create four data frames based on the predictors(gender, race, education level, household income) for future analysis.</p>
<pre class="r"><code>load_df =
GET(&quot;https://chronicdata.cdc.gov/resource/fqb7-mgjf.csv&quot;,
    query = list(&quot;$limit&quot; = 50000)) %&gt;% 
  content(&quot;parsed&quot;) %&gt;% 
  janitor::clean_names()


tidy_df = 
  load_df %&gt;% 
  filter(is.na(data_value_footnote)) %&gt;% 
  dplyr::select(-class, -topic, -question, -data_value_unit, -data_value_type, -data_source, -data_value_footnote_symbol, -data_value_footnote, -question_id, -class_id, -topic_id, -states, -counties) 

head(tidy_df) 

#gender
gender_df = 
  tidy_df %&gt;% 
  filter(break_out_category_id == &quot;CAT2&quot;) 
head(gender_df) 

#race
race_df = 
  tidy_df %&gt;% 
  filter(break_out_category_id == &quot;CAT4&quot;) 
head(race_df)

#education
education_df = 
  tidy_df %&gt;% 
  filter(break_out_category_id == &quot;CAT5&quot;) 
head(education_df) </code></pre>
<p>To get a time trend of obese/overweight for each state, we calculate prevalence in each year for each state. Using functions like <code>summary</code>, <code>group</code>, <code>filter</code> to calculate total population in each year for each state and total population in each year for each state.</p>
<pre class="r"><code># total population in each state in each year
df.tot = load_df %&gt;%
  group_by(year,locationdesc) %&gt;%
  summarise(state_sum = sum(sample_size))

# total &#39;obese&#39; and &#39;overweight&#39; amount in each state in each year
df.overweight = 
  load_df %&gt;%
  filter(response %in% c(&quot;Obese (BMI 30.0 - 99.8)&quot;,&quot;Overweight (BMI 25.0-29.9)&quot;,
                         &quot;Obese (bmi 30.0 - 99.8)&quot;,&quot;Overweight (bmi 25.0-29.9)&quot;)) %&gt;%
  group_by(year,locationdesc) %&gt;%
  summarise(state_overweight_sum = sum(sample_size))


df.rate = left_join(df.tot, df.overweight,
                   by = c(&quot;year&quot; , &quot;locationdesc&quot;)) %&gt;%
  mutate(over_rate = state_overweight_sum/state_sum)</code></pre>
<p>Next, cleaning data to find the state with highest average obese and overweight per year among all the states. After grouping data by locations and summing up mean value of obese/overweight, we find Nebraska has the highest average obese and overweight and we will choose this state for futher analysis.</p>
<pre class="r"><code>#cleaning data for nebraska
df.highest = df.rate %&gt;% 
  group_by(locationdesc) %&gt;%
  summarise(mean_overweight = mean(state_overweight_sum)) %&gt;%
  filter(mean_overweight == max(mean_overweight)) 


kable(df.highest, row.names = T, escape = F) %&gt;%
  kable_styling(bootstrap_options = &quot;striped&quot;, full_width = F)</code></pre>
<p>After choosing to focus on Nebraska, data were limited to this state. Dividing the number of people with obese/overweight by total number of population in the selected data multiplied by 100 to get the prevalence of obese/overweight for each year in Nebraska. Based on the data, we will visualize the obese/overweight differences by race, gender, education, and household income.</p>
<pre class="r"><code># prevalence of obese/obesity in Nebraska
time_df = 
  ne_df %&gt;% 
  filter(response_id %in% c(&quot;RESP039&quot;, &quot;RESP040&quot;) ) %&gt;% 
  select(year, response_id, sample_size) %&gt;% 
  group_by(year, response_id) %&gt;% 
  mutate(count_obese = sum(sample_size)) %&gt;% 
  select(-sample_size) %&gt;% 
  distinct()

total_df = 
  ne_df %&gt;%
  select(year, response_id, sample_size) %&gt;% 
  group_by(year) %&gt;% 
  mutate(count_total = sum(sample_size)) %&gt;% 
  select(-sample_size) %&gt;% 
  filter(response_id %in% c(&quot;RESP039&quot;, &quot;RESP040&quot;) ) %&gt;% 
  distinct() 

rate_time = 
  left_join(time_df, total_df,by = c(&quot;year&quot; , &quot;response_id&quot;)) %&gt;% 
  mutate(
    prevalence = count_obese / count_total,
    rate_lable = case_when(
      response_id == &quot;RESP039&quot; ~ &quot;Obese (BMI 30.0 - 99.8)&quot;,
      response_id == &quot;RESP040&quot; ~ &quot;Overweight (BMI 25.0-29.9)&quot;
    )
    ) %&gt;%
  mutate(prevalence = round(prevalence, digits = 4)) </code></pre>
</div>
</div>
<div id="exploratory-analysis" class="section level1">
<h1>Exploratory Analysis</h1>
<div id="how-obeseoverweight-change-from-2011-to-present-in-the-us" class="section level4">
<h4>1. How obese/overweight change from 2011 to present in the US?</h4>
<p>Use library(plotly) to visualizing the US obesity and overweight rate geographically (on a map), including the average amount of obesity and overweight from 2011 to 2019. It is clear that <strong>all states</strong> have as <strong>increasing</strong> trend of obese and overweight amount from 2011 to 2019.</p>
<pre class="r"><code># Use library(plotly) to visualizing the US obesity and overweight rate geographically (on a map), including the average amount of obesity and overweight from 2011 to 2019.
df.rate1 =  df.rate %&gt;%
  group_by(locationdesc)  %&gt;%
  mutate(mean_amount = mean(state_overweight_sum))

df.rate1 = df.rate1[-which(df.rate1$locationdesc %in% c(&quot;All States and DC (median) **&quot;,&quot;All States, DC and Territories (median) **&quot;,&quot;Virgin Islands&quot;) ),]
df.rate1$region = tolower(df.rate1$locationdesc)

states = map_data(&quot;state&quot;)
# merge the datasets
states = merge(states, df.rate1, by = &quot;region&quot;, all.x = T)

##### US states obesity time trend: scatter plot with line
ggplot(data = df.rate[-which(df.rate$locationdesc %in% c(&quot;All States and DC (median) **&quot;,&quot;All States, DC and Territories (median) **&quot;,&quot;Virgin Islands&quot;) ),], 
       aes(year, y = over_rate)) +
  geom_line(aes(color = locationdesc)) +
  geom_point(aes(color = locationdesc),size = 1.5) +
  facet_wrap(~ locationdesc) +
  theme(legend.position = &quot;None&quot;,
        #text = element_text(family=&#39;Kai&#39;),
        axis.text.x = element_text(angle = 90, hjust = 1)) +
  scale_x_continuous(breaks = seq(2011,2019,1)) +
  xlab(&quot;Year&quot;) + ylab(&quot;Obesity and overweight rate&quot;) +
  ggtitle(&quot;Obesity and overweight rate trend for all the states&quot;)</code></pre>
</div>
<div id="what-is-the-distribution-of-obeseoverweight-by-gender-race-education-level-household-income-in-nebraska" class="section level4">
<h4>2. What is the distribution of obese/overweight by gender, race, education level, household income in Nebraska?</h4>
<p><strong>Prevalence of obese/overweight in Nebraska:</strong></p>
<p>According to overview, Nebraska owns the <strong>highest</strong> rate of overweight and obese. From the line plot, we can see the prevalence of overweight decreased slightly while the prevalence of obese <strong>increased</strong> significantly over year. The total rate of people whose BMI is greater than 25 reaches almost 70% (rate of obese is 36%) in 2019.</p>
<pre class="r"><code>rate_time %&gt;%
  group_by(rate_lable) %&gt;% 
  mutate(text_label = str_c(&quot;Year:&quot;, year, &quot;\nPrevalence:&quot;, prevalence)) %&gt;% 
  plot_ly( 
    x = ~year, 
    y = ~prevalence, 
    #type = &#39;scatter&#39;, 
    #mode = &quot;lines+markers&quot;, 
    textposition = &quot;bottom right&quot;,  
    color = ~rate_lable, 
    colors = c(&#39;#FFD700&#39;, &#39;#FF8C00&#39;),
    text = ~text_label, 
    line = list(simplyfy = F),
    alpha = 0.8
    ) %&gt;% 
  layout(
    legend = list(x = 0.5, y = 0.15),
    title = &quot;Obesity rate trend over time&quot;,
         xaxis = list(title = &quot;Year&quot;,
                      zeroline = TRUE),
         yaxis = list(title = &quot;Prevalence&quot;,
                      zeroline = TRUE),
     updatemenus = list(
      list(
        x = 0.7,
        y = 0.4,
        buttons = list(

          list(method = &quot;restyle&quot;,
               args = list(&quot;type&quot;, &quot;scatter&quot;),
               label = &quot;Line&quot;),

          list(method = &quot;restyle&quot;,
               args = list(&quot;type&quot;, &quot;bar&quot;),
               label = &quot;bar&quot;)))
    )
    ) </code></pre>
<p><strong>Obese/overweight by Race/Ethnicity:</strong></p>
<p>Combining data from 2011 through 2019, <code>non-Hispanic American Indian or Alaskan Native</code> had the <strong>highest</strong> prevalence of self-reported obesity (47.13%), followed by <code>non-Hispanic Black adults</code> (41.81%) and<br />
<code>non-Hispanic Multiracial</code>(39.74%). <code>Non-Hispanic White adults</code> own the <strong>lowest</strong> obesity rate(31.95%).</p>
<pre class="r"><code>ne_race_df = 
  ne_df %&gt;% 
  filter(break_out_category_id == &quot;CAT4&quot;) %&gt;% 
  select(year, locationabbr, locationdesc, response, break_out, sample_size, response_id) %&gt;% 
  group_by(year, break_out) %&gt;% 
  mutate(count_race = sum(sample_size)) %&gt;% 
  filter(response_id %in% c(&quot;RESP039&quot;) ) %&gt;% 
  mutate(race_pre = round(sample_size / count_race, digit = 4))

obesity_rate_by_race = 
  ne_race_df %&gt;% 
  group_by(break_out) %&gt;% 
  mutate(sum_race = sum(sample_size),
         sum_obese = sum(count_race),
         obesity_rate = round(sum_race/sum_obese, digits = 4)) %&gt;% 
  select(break_out, obesity_rate) %&gt;% 
  distinct() %&gt;% 
  arrange(desc(obesity_rate))

fig_race_2 = 
  ne_race_df %&gt;% 
  filter(break_out != &quot;Other, non-Hispanic&quot;) %&gt;% 
  mutate(text_label = str_c(&quot;Race/Ethnicity:&quot;, break_out, &quot;\nPrevalence:&quot;, race_pre)) %&gt;% 
  plot_ly( x = ~year , y = ~race_pre,  type = &quot;bar&quot;, color = ~break_out, text = ~text_label, alpha = 0.7) %&gt;% 
  layout(
         
         title = &quot;Difference between race group over year&quot;,  
         legend = list(font = list(size = 8),  x = 0.5, y = 0.05),
         xaxis = list(title = &quot;Year&quot;,
                      zeroline = TRUE,
                            rangeselector = list(
        buttons = list(
          list(
            count = 3,
            label = &quot;3 year&quot;,
            step = &quot;year&quot;,
            stepmode = &quot;backward&quot;),
          list(
            count = 6,
            label = &quot;6 year&quot;,
            step = &quot;year&quot;,
            stepmode = &quot;backward&quot;),
          list(
            count = 1,
            label = &quot;YTD&quot;,
            step = &quot;year&quot;,
            stepmode = &quot;todate&quot;),
          list(step = &quot;all&quot;))),

      rangeslider = list(type = &quot;date&quot;)
                      ),
                      
         
         yaxis = list(title = &quot;Prevalence&quot;,
                      zeroline = TRUE)) 


fig_race_2</code></pre>
<p><strong>Obese/overweight by gender:</strong></p>
<p>According to the plot, the obesity rate of both women and men kept increasing over year and exceeded 0.35 since 2018. However, obesity rate of <strong>women</strong> always significantly <strong>lower</strong> than that of man.</p>
<pre class="r"><code>ne_gender_df = 
  ne_df %&gt;% 
  filter(break_out_category_id == &quot;CAT2&quot;) %&gt;% 
  select(year, locationabbr, locationdesc, response, break_out, sample_size, response_id) %&gt;% 
  group_by(year, break_out) %&gt;% 
  mutate(count_gender = sum(sample_size)) %&gt;% 
  filter(response_id %in% c(&quot;RESP039&quot;) ) %&gt;% 
  mutate(gender_pre = round(sample_size / count_gender, digit = 4))

ay = list(
  tickfont = list(color = &quot;#767B84&quot;),
  overlaying = &quot;y&quot;,
  side = &quot;right&quot;,
  title = &quot;Prevalence&quot;,
  automargin = TRUE
)
ne_gender_df %&gt;%
  group_by(break_out) %&gt;% 
  mutate(
    text_label_1 = str_c(&quot;gender:&quot;, break_out, &quot;\nCount:&quot;, sample_size),
    text_label_2 = str_c(&quot;gender:&quot;, break_out, &quot;\nPrevalence:&quot;, gender_pre)     
    ) %&gt;% 
  plot_ly( 
    x = ~year, 
    y = ~sample_size,  
    type = &quot;bar&quot;, 
    color = ~break_out, 
    colors = c(&quot;#F1948A&quot;, &quot;#85C1E9&quot;),
    text = ~text_label_1, 
    alpha = 0.7) %&gt;% 
    add_lines(x = ~year, y = ~gender_pre, color = ~break_out, text = ~text_label_2, yaxis = &quot;y2&quot;) %&gt;% 
  layout(
         title = &quot;Obesity rate by gender&quot;,
         xaxis = list(title = &quot;year&quot;,
                      zeroline = TRUE),
         yaxis = list(title = &quot;Count&quot;,
                      zeroline = TRUE),
         yaxis2 = ay,
         legend = list(  
                     x = 0.7,
                     y = 0.1)
         )</code></pre>
<p><strong>Obese/Overweight approximately decreased by level of education:</strong></p>
<p>The level of Education people have are divided into 4 levels, showing bellow in an increasing order:<br />
<br>-<code>Less than H.S</code>: People didn’t attend high school <br>-<code>H.S. or G.E.D</code>: High school graduates or people pass General Educational Development test <br>-<code>Some post-H.S</code>: Any school or specialized training which takes place after high school graduation <br>-<code>College graduate</code>:College graduates</p>
<p>The pie plot shows that the rate of <code>H.S or G.E.D</code> and <code>Some post-H.S</code> are all around 30%, and the rate of <code>Less than H.S</code> is 6%. According to the line plot, the obese/overweight of all groups kept increasing over year. <code>College graduate group</code> always owns the lowest obese/overweight rate, which might benefit of their self-discipline. <code>Less than H.S group</code> owns the highest obesity rate, however, the rate dropped dramatically between 2018 and 2019. The lines of <code>Less than H.S group</code>, <code>Some post-H.S group</code>, and <code>H.S or G.E.D group</code> intersects. From the trend, we conclude that the obese/obesity rate <strong>decrease</strong> as education level <strong>increase</strong>.</p>
<pre class="r"><code>ne_edu_df = 
  ne_df %&gt;% 
  filter(break_out_category_id == &quot;CAT5&quot;) %&gt;% 
  select(year, locationabbr, locationdesc, response, break_out, sample_size, response_id) %&gt;% 
  group_by(year, break_out) %&gt;% 
  mutate(count_edu = sum(sample_size)) %&gt;% 
  filter(response_id %in% c(&quot;RESP039&quot;) ) %&gt;% 
  mutate(edu_pre = round(sample_size / count_edu, digit = 4))

edu_rate = 
  ne_edu_df %&gt;% 
  select(break_out, count_edu, year) %&gt;% 
  distinct() %&gt;% 
  group_by(break_out) %&gt;% 
  mutate(sum_edu = round(sum(count_edu/9), digits = 0))

fig_edu_1 = 
  edu_rate %&gt;% 
  plot_ly(labels = ~break_out, values = ~sum_edu, 
        textposition = &#39;inside&#39;,
        textinfo = &#39;label+percent&#39;,
        insidetextfont = list(color = &#39;#483C32&#39;),
        hoverinfo = &#39;text&#39;,
        domain = list(row = 0, column = 1),
        text = ~paste(&#39;Education Attained:&#39;, break_out, &#39; \nNumber&#39;, count_edu),
        marker = list(colors = c(&#39;#6f4d96&#39;,&#39;#f3cec9&#39;,&#39;#cd7eaf&#39;,&#39;#e7a4b6&#39;),
                      line = list(color = &#39;#FFFFFF&#39;, width = 1)),
        showlegend = F
        ) %&gt;% add_pie(hole = 0.5)

fig_edu_2 = 
  ne_edu_df %&gt;% 
  group_by(break_out) %&gt;% 
  mutate(text_label = str_c(&quot;Education Attained:&quot;, break_out, &quot;\nPrevalence:&quot;, edu_pre)) %&gt;% 
  plot_ly( 
    x = ~year , 
    y = ~edu_pre, 
    domain = list(row = 0, column = 0),
    type = &#39;scatter&#39;, 
    mode = &quot;lines+markers&quot;, 
    #type = &quot;bar&quot;, 
    color = ~break_out, 
    colors = c(&#39;#6f4d96&#39;, &#39;#e7a4b6&#39;, &#39;#f3cec9&#39;,&#39;#cd7eaf&#39; ),
    text = ~text_label,
    alpha = 0.7) %&gt;% 
  layout(
         title = &quot;Obesity rate by Education&quot;,  
         legend = list( showlegend = T),
         xaxis = list(title = &quot;Education Attained&quot;,
                      zeroline = TRUE),
         yaxis = list(title = &quot;Prevalence&quot;,
                      zeroline = TRUE)) 

subplot(fig_edu_2 , fig_edu_1) %&gt;%  layout(legend = list(x = 0.3, y = 0.04, font = list(size = 8), showlegend = F), grid = list(rows = 1, columns = 2))</code></pre>
<p><strong>Obese/Obesity rate trend of household income:</strong><br />
From the plots, we can see people with <strong>lower</strong> household income tend to have <strong>higher</strong> obese rate and <strong>lower</strong> overweight rate. The overweight rate decreased while obesity rate increased over time.</p>
<pre class="r"><code>ne_income_df = 
  ne_df %&gt;% 
  filter(break_out_category_id == &quot;CAT6&quot;) %&gt;% 
  select(year, locationabbr, locationdesc, response, break_out, sample_size, response_id) %&gt;% 
  group_by(year, break_out) %&gt;% 
  mutate(count_income = sum(sample_size)) %&gt;% 
  filter(response_id %in% c(&quot;RESP039&quot;, &quot;RESP040&quot;)) %&gt;% 
  mutate(
    income_pre = round(sample_size / count_income, digit = 4),
    rate_lable = case_when(
      response_id == &quot;RESP039&quot; ~ &quot;Obese (BMI 30.0 - 99.8)&quot;,
      response_id == &quot;RESP040&quot; ~ &quot;Overweight (BMI 25.0-29.9)&quot;)
    
    )
  

  ne_income_df %&gt;% 
    mutate(break_out = factor(break_out, levels = c(&quot;Less than $15,000&quot;, &quot;$15,000-$24,999&quot;, &quot;$25,000-$34,999&quot;, &quot;$35,000-$49,999&quot;, &quot;$50,000+&quot;))) %&gt;% 
   ggplot(aes(x = year, y = income_pre, color = rate_lable)) +
   geom_line(size = 1) +
   scale_color_manual(values=c(&quot;#20B2AA&quot;, &quot;#228B22&quot;)) +
   theme_bw() +
   theme(aspect.ratio = 1, axis.text.x = element_text(angle = 45,  hjust = 1)) +
   facet_wrap(~break_out) +
   theme(legend.position = &quot;bottom&quot;) +
    labs(title = &quot;Obesity rate by household income&quot;,
       subtitle = &quot;2011 - 2019.&quot;,
       x = &quot;Year&quot;, 
       y = &quot;Prevalence&quot;) +
  scale_x_continuous(breaks = seq(2011,2019,1)) </code></pre>
</div>
</div>
<div id="additional-analysis" class="section level1">
<h1>Additional Analysis</h1>
</div>
<div id="discussion" class="section level1">
<h1>Discussion</h1>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
